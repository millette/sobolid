import{c as O,o as Z,g as U,h as V,i as a,a as u,j as v,k as I,b as E,s as S,t as x,d as M,m as ee,F as j,n as G,p as te,S as ne,T as re}from"./vendor.51d0a8a9.js";import{p as f}from"./index.68ceb3a9.js";function le(e){const t=e.indexOf("_of_");if(t===-1)return{name:e,n:1};const c=parseInt(e.slice(t+4),10);return{name:e.slice(0,t-2),n:c}}async function se(e){const c=await(await fetch(`${f}${e}`)).text(),_=new DOMParser().parseFromString(c,"image/svg+xml"),g=new Map;return _.querySelectorAll("symbol").forEach($=>{const{name:m,n:w}=le($.getAttribute("id"));g.set(`${e}#${m}`,w)}),Array.from(g)}function ie(e){const t=(e==null?void 0:e.api)?Array.isArray(e.api)?e.api:[e.api]:[globalThis.localStorage].filter(Boolean),c=(e==null?void 0:e.prefix)?`${e.prefix}.`:"",r=new Map,_=new Proxy({},{get(l,n){let s=r.get(n);s||(s=O(void 0,{equals:!1}),r.set(n,s)),s[0]();const o=t.reduce((i,N)=>i!==null||!N?i:N.getItem(`${c}${n}`),null);return o!==null&&(e==null?void 0:e.deserializer)?e.deserializer(o,n,e==null?void 0:e.options):o}}),g=(l,n,s)=>{const o=(e==null?void 0:e.serializer)?e.serializer(n,l,s??(e==null?void 0:e.options)):n;t.forEach(N=>N.setItem(`${c}${l}`,o));const i=r.get(l);i&&i[1]()},$=l=>t.forEach(n=>n.removeItem(l)),m=()=>t.forEach(l=>{var n;return(n=l==null?void 0:l.clear)==null?void 0:n.call(l)}),w=()=>{const l={},n=(s,o)=>{if(!l.hasOwnProperty(s)){const i=o&&(e==null?void 0:e.deserializer)?e.deserializer(o,s,e==null?void 0:e.options):o;i&&(l[s]=i)}};return t.forEach(s=>{if(typeof s.getAll=="function"){const o=s.getAll();for(const i of o)n(i,o[i])}else{let o=0,i;for(;i=s.key(o++);)l.hasOwnProperty(i)||n(i,s.getItem(i))}}),l};return Z(()=>{const l=n=>{var s;let o=!1;t.forEach(i=>{i!==n.storageArea&&n.key&&n.newValue!==i.getItem(n.key)&&(n.newValue?i.setItem(n.key,n.newValue):i.removeItem(n.key),o=!0)}),o&&n.key&&((s=r.get(n.key))==null||s[1]())};"addEventListener"in globalThis?(globalThis.addEventListener("storage",l),U(()=>globalThis.removeEventListener("storage",l))):(t.forEach(n=>{var s;return(s=n.addEventListener)==null?void 0:s.call(n,"storage",l)}),U(()=>t.forEach(n=>{var s;return(s=n.removeEventListener)==null?void 0:s.call(n,"storage",l)})))}),[_,g,{clear:m,remove:$,toJSON:w}]}const[oe,K,{clear:ce,remove:ae,toJSON:ue}]=ie();function de(){const e=ue(),t={};let c;for(c in e)c!=="_bodyType"&&(t[c]=JSON.parse(e[c]));return t}const[C,Q]=O(de());function ge(e,t){K(e,JSON.stringify(t));const c={...C()};c[e]=t,Q(c)}function z(e){ae(e);const t={...C()};delete t[e],Q(t)}function he(e){return C()[e]!==void 0}function fe(){return oe._bodyType||0}function $e(e){K("_bodyType",e)}const ve=x('<ul class="flex items-center"><li class="flex-1"><button class="p-2 text-white bg-indigo-600 rounded-full">\u2B05 Previous</button></li><li class="flex-1 text-right"><button class="p-2 text-white bg-indigo-600 rounded-full">Next \u27A1</button></li></ul>'),_e=x("<span>[remove]</span>"),T=x("<svg><use></use></svg>",4,!0),me=x('<div><div><p>Name: </p><p>Layers: </p><p>Item: <!> (<!> of <!>)</p></div><svg viewBox="0 0 560 560" class="bg-white"><use></use></svg></div>'),we=x('<div class="border-solid border-4 border-teal-600"></div>');function be(e){const[t,c]=O(0),[r]=V(e.partsFileName,se);function _(){return r()[t()][1]>1?`${r()[t()][0]}_1_of_${r()[t()][1]}`:r()[t()][0]}function g(){return r()[t()][1]>1?`${r()[t()][0]}_2_of_${r()[t()][1]}`:""}function $(){return r()[t()][1]>2?`${r()[t()][0]}_3_of_${r()[t()][1]}`:""}function m(){return r()[t()][1]>3?`${r()[t()][0]}_4_of_${r()[t()][1]}`:""}function w(){return r()[t()][1]>4?`${r()[t()][0]}_5_of_${r()[t()][1]}`:""}function l(){return r()[t()][1]>5?`${r()[t()][0]}_6_of_${r()[t()][1]}`:""}function n(){r().length!==1&&(t()+1===r().length?c(0):c(t()+1))}function s(){r().length!==1&&(t()===0?c(r().length-1):c(t()-1))}function o(){const b=r()[t()][0].split("#");return{type:b[0].slice(14,-4),item:b[1]}}function i(b){ge(b,[_(),g(),$(),m(),w(),l()].filter(Boolean))}function N(b){z(b)}return(()=>{const b=we.cloneNode(!0);return a(b,u(v,{get when(){return!r.loading},get children(){const k=me.cloneNode(!0),F=k.firstChild,d=F.firstChild;d.firstChild;const y=d.nextSibling;y.firstChild;const p=y.nextSibling,L=p.firstChild,B=L.nextSibling,W=B.nextSibling,D=W.nextSibling,X=D.nextSibling,q=X.nextSibling;q.nextSibling;const A=F.nextSibling,P=A.firstChild;return a(k,u(v,{get when(){return r().length>1},get children(){const h=ve.cloneNode(!0),H=h.firstChild,Y=H.nextSibling;return H.$$click=s,Y.$$click=n,h}}),F),a(d,()=>o().type,null),a(d,u(v,{get when(){return he(o().type)},get children(){const h=_e.cloneNode(!0);return I(h,"click",N.bind(null,o().type),!0),h}}),null),a(y,()=>r()[t()][1],null),a(p,()=>o().item,B),a(p,()=>t()+1,D),a(p,()=>r().length,q),I(A,"click",i.bind(null,o().type),!0),a(A,u(v,{get when(){return l()},get children(){const h=T.cloneNode(!0);return E(()=>S(h,"href",`${f}${l()}`)),h}}),P),a(A,u(v,{get when(){return w()},get children(){const h=T.cloneNode(!0);return E(()=>S(h,"href",`${f}${w()}`)),h}}),P),a(A,u(v,{get when(){return m()},get children(){const h=T.cloneNode(!0);return E(()=>S(h,"href",`${f}${m()}`)),h}}),P),a(A,u(v,{get when(){return $()},get children(){const h=T.cloneNode(!0);return E(()=>S(h,"href",`${f}${$()}`)),h}}),P),a(A,u(v,{get when(){return g()},get children(){const h=T.cloneNode(!0);return E(()=>S(h,"href",`${f}${g()}`)),h}}),P),E(()=>S(P,"href",`${f}${_()}`)),k}})),b})()}M(["click"]);const ye=x("<b>Start adding parts to the character.</b>"),pe=x('<button class="p-3 bg-red-600 text-white-300">RESET</button>'),xe=x('<svg viewBox="0 0 560 560" class="bg-white"><use></use><use></use><use></use><use></use></svg>'),Ne=x('<div><ul class="flex items-center"></ul><p></p></div>'),Se=x('<div class="border-solid border-4 border-teal-600"></div>'),ke=x('<li class="flex-1"><button class="p-2 text-white bg-red-600 rounded-full"></button></li>'),J=x("<svg><use></use></svg>",4,!0),R=te(()=>Object.keys(C()).length);function Ee(e){const t=e.split("_");return t.length===2&&(t[1]==="left"||t[1]==="right")?{name:void 0,more:e}:{name:t.slice(-1)[0],more:t.slice(0,-1).join("_")}}async function Ce(e){const c=await(await fetch(`${f}${e}`)).text(),_=new DOMParser().parseFromString(c,"image/svg+xml"),g=new Map;return _.querySelectorAll("symbol").forEach($=>{const{name:m,more:w}=Ee($.getAttribute("id")),l=g.get(m);l?(l.push(w),g.set(m,l)):g.set(m,[w])}),Array.from(g)}function Ae(e){const[t,c]=O(fe()),[r]=V(e.partsFileName,Ce);ee(()=>{$e(t())});function _(){const[l,n]=r()[t()];return n.map(s=>`${s}_${l}`)}function g(l,n){return`${l}_${n.slice(20+l.length)}`}function $(l,n){const s=g(l,n);return e.layers().bodyBack.find(o=>o===s)!==void 0}function m(l,n){const s=g(l,n);return e.layers().bodyFront.find(o=>o===s)!==void 0}function w(){console.log("CLEAR"),ce(),c(0),window.location.href=window.location.href+"?cleared"}return(()=>{const l=Se.cloneNode(!0);return a(l,u(v,{get when(){return!r.loading&&!e.layers.loading},get children(){const n=Ne.cloneNode(!0),s=n.firstChild,o=s.nextSibling;return a(s,u(j,{get each(){return r()},children:(i,N)=>u(v,{get when(){return i[0]},get children(){const b=ke.cloneNode(!0),k=b.firstChild;return I(k,"click",c.bind(null,N()),!0),a(k,()=>i[0]),b}})})),a(o,u(v,{get when(){return!R()},get children(){return ye.cloneNode(!0)}}),null),a(o,u(v,{get when(){return R()},get children(){return["Number of parts: ",G(()=>R()),"."," ",(()=>{const i=pe.cloneNode(!0);return i.$$click=w,i})()]}}),null),a(n,u(v,{get when(){return _().length>0},fallback:"Pick a body type",get children(){const i=xe.cloneNode(!0),N=i.firstChild,b=N.nextSibling,k=b.nextSibling,F=k.nextSibling;return a(i,u(j,{get each(){return Object.keys(C())},children:d=>u(j,{get each(){return C()[d]},children:y=>u(v,{get when(){return $(d,y)},get children(){const p=J.cloneNode(!0);return I(p,"click",z.bind(null,d),!0),S(p,"href",`${f}${y}`),p}})})}),N),a(i,u(j,{get each(){return _().reverse()},children:d=>(()=>{const y=J.cloneNode(!0);return E(()=>S(y,"href",`${f}${e.partsFileName}#${d}`)),y})()}),N),a(i,u(j,{get each(){return Object.keys(C())},children:d=>u(j,{get each(){return C()[d]},children:y=>u(v,{get when(){return m(d,y)},get children(){const p=J.cloneNode(!0);return I(p,"click",z.bind(null,d),!0),S(p,"href",`${f}${y}`),p}})})}),null),E(d=>{const y=`${f}${e.partsFileName}#ifoot_left`,p=`${f}${e.partsFileName}#ifoot_right`,L=`${f}${e.partsFileName}#ihand_left`,B=`${f}${e.partsFileName}#ihand_right`;return y!==d._v$&&S(N,"href",d._v$=y),p!==d._v$2&&S(b,"href",d._v$2=p),L!==d._v$3&&S(k,"href",d._v$3=L),B!==d._v$4&&S(F,"href",d._v$4=B),d},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),i}}),null),n}})),l})()}M(["click"]);function je(e){return u(Ae,{get layers(){return e.layers},partsFileName:"sprites/whole-body.svg"})}const Pe=x('<section class="bg-pink-100 text-gray-700 p-8"><h1 class="text-2xl font-bold">Credits</h1><details><summary>PRE </summary><pre></pre></details><div class="grid gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4"></div></section>'),Ie=x("<div>Loading...</div>"),Fe=x("<div><button></button></div>");async function Be(){const t=await(await fetch(`${f}manifest.json`)).json(),c=new TextEncoder().encode(t);if(!(crypto&&crypto.subtle&&crypto.subtle.digest))return"v.unknown";const r=await crypto.subtle.digest("SHA-256",c),g=Array.from(new Uint8Array(r)).map($=>$.toString(16).padStart(2,"0")).join("");return"v."+g.slice(0,10)}const[Oe]=V(`${f}manifst.json`,Be),Te=["sprites/whole-armband.svg","sprites/whole-belt.svg","sprites/whole-button.svg","sprites/whole-cloak.svg","sprites/whole-coat.svg","sprites/whole-gloves.svg","sprites/whole-holster.svg","sprites/whole-jacket.svg","sprites/whole-kneepads.svg","sprites/whole-necklace.svg","sprites/whole-pants.svg","sprites/whole-pet.svg","sprites/whole-scarf.svg","sprites/whole-scar.svg","sprites/whole-shirt.svg","sprites/whole-shoes.svg","sprites/whole-shoulderpads.svg","sprites/whole-socks.svg","sprites/whole-suit.svg","sprites/whole-tatoo.svg","sprites/whole-tie.svg","sprites/whole-underwear.svg","sprites/whole-vest.svg","sprites/whole-watch.svg","sprites/whole-wings.svg"];function Le(e){return e.slice(14,-4)}async function Ve(e){return await(await fetch(e)).json()}function Je(){const[e,t]=O(0),[c]=V(`${f}sprites/male-body_front_swaying.json`,Ve);return(()=>{const r=Pe.cloneNode(!0),_=r.firstChild,g=_.nextSibling,$=g.firstChild;$.firstChild;const m=$.nextSibling,w=g.nextSibling;return a(r,u(re,{get children(){return["Credits page",u(ne,{get children(){return[" (",G(()=>Oe()),")"]}})]}}),_),a($,()=>c.loading?"loading...":"ready",null),a(m,()=>JSON.stringify(c(),null,2)),a(r,u(je,{layers:c}),w),a(w,u(j,{each:Te,get fallback(){return Ie.cloneNode(!0)},children:(l,n)=>(()=>{const s=Fe.cloneNode(!0),o=s.firstChild;return I(o,"click",t.bind(null,n()),!0),a(o,()=>Le(l)),a(s,u(v,{get when(){return n()===e()},get children(){return u(be,{layers:c,partsFileName:l})}}),null),s})()})),r})()}M(["click"]);export{Je as default};
